  - name: Ensure that we can conduct a query on the ComponentEndpoints collection
    request:
      url: "{hsm_base_url}/hsm/v2/Inventory/ComponentEndpoints"
      method: GET
      verify: !bool "{verify}"
    response:
      status_code: 200
      verify_response_with:
        function: tavern.testutils.helpers:validate_pykwalify
        extra_kwargs:
          schema:
            type: map
            required: True
            mapping:
              ComponentEndpoints:
                type: seq
                matching: all
                required: True
                sequence:
                  - type: map
                    required: True
                    mapping:
                      ID:
                        type: str
                        required: True
                        pattern: "x[0-9]+[cm][0-9]+.*"
                      Type:
                        type: str
                        required: True
                        enum:
                          - "CabinetPDUController"
                          - "CabinetPDUPowerConnector"
                          - "CabinetPDU"
                          - "ChassisBMC"
                          - "Chassis"
                          - "ComputeModule"
                          - "HSNBoard"
                          - "NodeBMC"
                          - "NodeEnclosure"
                          - "Node"
                          - "RouterBMC"
                          - "RouterModule"
                      RedfishType:
                        type: str
                        required: True
                        enum:
                          - "C13"
                          - "Chassis"
                          - "ComputerSystem"
                          - "Manager"
                          - "Outlet"
                          - "PowerDistribution"
                      RedfishSubtype:
                        type: str
                        required: True
                        enum:

                          - ""
                          - "AuxiliaryController"
                          - "Blade"
                          - "BMC"
                          - "C13"
                          - "Cx"
                          - "Enclosure"
                          - "EnclosureManager"
                          - "IEC_60320_C13"
                          - "IEC_60320_C19"
                          - "Physical"
                          - "RackMount"
                          - "RackPDU"
                          - "StandAlone"
                      MACAddr:
                        type: str
                        required: False
                        pattern: "[a-z0-9]{{2}}(:[a-z0-9]{{2}}){{5}}"
                      UUID:
                        type: str
                        required: False

                        pattern: "[a-zA-Z0-9]{{8}}-[a-zA-Z0-9]{{4}}-[a-zA-Z0-9]{{4}}-[a-zA-Z0-9]{{4}}-[a-zA-Z0-9]{{12}}|NULL"
                      OdataID:
                        type: str
                        required: True
                        pattern: "/redfish/v1/.*"
                      RedfishEndpointID:
                        type: str
                        required: True
                        pattern: "x[0-9]+[cm][0-9]+.*"
                      Enabled:
                        type: bool
                        required: True
                      RedfishEndpointID:
                        type: str
                        required: True
                        pattern: "x[0-9]+[cm][0-9]+.*"
                      RedfishURL:
                        type: str
                        required: True
                        pattern: "x[0-9]+[cm][0-9]+.*/redfish/v1/.*"
                      ComponentEndpointType:
                        type: str
                        required: True
                        enum:
                          - "ComponentEndpointChassis"
                          - "ComponentEndpointComputerSystem"
                          - "ComponentEndpointManager"
                          - "ComponentEndpointOutlet"
                          - "ComponentEndpointPowerDistribution"
                      RedfishChassisInfo:
                        type: map
                        required: False
                        mapping:
                          Name:
                            type: str
                            required: True
                          Actions:
                            type: map
                            required: False
                            allowempty: True
                      RedfishEndpointFQDN:
                        type: str
                        required: True
                        pattern: "x[0-9]+[cm][0-9]+.*"
                      RedfishManagerInfo:
                        type: map
                        required: False
                        mapping:
                          Name:
                            type: str
                            required: True
                          Actions:
                            type: map

                            required: False
                            allowempty: True
                          EthernetNICInfo:
                            type: seq
                            matching: all

                            required: False
                            sequence:
                              - type: map
                                required: True
                                mapping:
                                  RedfishId:
                                    type: str
                                    required: True
                                    length:
                                      min: 1
                                    pattern: "[0-9]+|\
bond[0-9]+|\
usb[0-9]+"
                                  "@odata.id":
                                    type: str
                                    required: False
                                  Description:
                                    type: str
                                    required: False
                                  FQDN:
                                    type: str
                                    required: False
                                  Hostname:
                                    type: str
                                    required: False
                                  InterfaceEnabled:
                                    type: bool
                                    required: False
                                  MACAddress:
                                    type: str
                                    required: False
                                  PermanentMACAddress:
                                    type: str
                                    required: False
                                    pattern: "[a-z0-9]{{2}}(:[a-z0-9]{{2}}){{5}}"
                      RedfishOutletInfo:
                        type: map
                        required: False
                        mapping:
                          Name:
                            type: str
                            required: True
                          Actions:
                            type: map
                            required: False
                            allowempty: True
                      RedfishPDUInfo:
                        type: map
                        required: False
                        mapping:
                          Name:
                            type: str

                            required: False
                          Actions:
                            type: map
                            required: False
                            allowempty: True
                      RedfishSystemInfo:
                        type: map
                        required: False
                        mapping:
                          Name:
                            type: str
                            required: True
                          Actions:
                            type: map
                            required: True
                            allowempty: True
                          EthernetNICInfo:
                            type: seq
                            matching: all
                            required: False
                            sequence:
                              - type: map
                                required: True
                                mapping:
                                  RedfishId:
                                    type: str
                                    required: True


                                    pattern: "^$|\
[0-9]+|\
HPCNet[0-9]+|\
ManagementEthernet|\
DE[0-9A-Za-z]+"
                                  "@odata.id":
                                    type: str
                                    required: False
                                  InterfaceEnabled:
                                    type: bool
                                    required: False
                                  Description:
                                    type: str
                                    required: False
                                  MACAddress:
                                    type: str
                                    required: False
                                  PermanentMACAddress:
                                    type: str
                                    required: False

                                    pattern: "[a-z0-9]{{2}}(:[a-z0-9]{{2}}){{5}}|\
Not Available"
                          PowerURL:
                            type: str
                            required: False
                          Controls:
                            type: seq
                            matching: all
                            required: False
                            sequence:
                              - type: map
                                required: True
                                mapping:
                                  URL:
                                    type: str
                                    required: True
                                  Control:
                                    type: map
                                    required: True
                                    mapping:
                                      ControlDelaySeconds:
                                        type: int
                                        required: True
                                      ControlMode:
                                        type: str
                                        required: True
                                      ControlType:
                                        type: str
                                        required: True
                                      Id:
                                        type: str
                                        required: True
                                      Name:
                                        type: str
                                        required: True
                                      PhysicalContext:
                                        type: str
                                        required: True
                                      SetPoint:
                                        type: int
                                        required: True
                                      SetPointUnits:
                                        type: str
                                        required: True
                                      SettingRangeMax:
                                        type: int
                                        required: True
                                      SettingRangeMin:
                                        type: int
                                        required: True
                                      Status:
                                        type: map
                                        required: True
                                        mapping:
                                          Health:
                                            type: str
                                            required: True
                                            enum:
                                              - "OK"
                          PowerControl:
                            type: seq
                            matching: all
                            required: False
                            sequence:
                              - type: map
                                required: True

                                allowempty: True
                                mapping:
                                  MemberId:
                                    type: str
                                    required: True
                                    pattern: "[0-9]+|\
Node|\
Accelerator[0-9]+"
                                  "@odata.id":
                                    type: str
                                    required: True
                                  PowerCapacityWatts:
                                    type: int
                                    required: False
                                  Name:
                                    type: str
                                    required: False
                                  RelatedItem:
                                    type: seq
                                    matching: all
                                    required: False
                                    sequence:
                                      - type: map
                                        required: True
                                        mapping:
                                          "@odata.id":
                                            type: str
                                            required: True
