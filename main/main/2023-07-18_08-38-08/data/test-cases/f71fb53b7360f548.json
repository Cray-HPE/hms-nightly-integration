{"uid":"f71fb53b7360f548","name":"Verify negative cases for the HMNFD /subscriptions API","fullName":"api.1-non-disruptive.test_subscriptions_negative.tavern#Verify negative cases for the HMNFD /subscriptions API","historyId":"e0735a7d07c9231aa06e45d7d71f9c36","time":{"start":1689667775277,"stop":1689667775383,"duration":106},"status":"failed","statusMessage":"tavern.util.exceptions.MissingFormatError: test_agent","statusTrace":"Format variables:\n  hmnfd_base_url = 'http://cray-hmnfd:28600'\n  test_agent = '???'\n  verify = 'False'\n  test_agent = '???'\n\nSource test stage (line 178):\n  - name: Verify that HMNFD properly handles requests to create state change notification subscriptions for invalid xnames\n    request:\n      url: \"{hmnfd_base_url}/hmi/v2/subscriptions/fake/agents/{test_agent}\"\n      method: POST\n      verify: !bool \"{verify}\"\n    response:\n      status_code: 400\n      verify_response_with:\n        function: tavern.testutils.helpers:validate_pykwalify\n        extra_kwargs:\n          schema:\n            type: map\n            mapping:\n              type:\n                type: str\n                required: True\n                enum:\n                  - \"about:blank\"\n              title:\n                type: str\n                required: True\n                enum:\n                  - \"Invalid Request\"\n              detail:\n                type: str\n                required: True\n                enum:\n                  - \"Invalid XName in URL path\"\n              instance:\n                type: str\n                required: True\n                enum:\n                  - \"/hmi/v2/subscriptions/fake/agents/{test_agent}\"\n              status:\n                type: int\n                required: True\n                enum:\n                  - 400\n\n\n\nMissing format vars for stage\n\nErrors:\nE   tavern.util.exceptions.MissingFormatError: test_agent","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"failed","statusMessage":"tavern.util.exceptions.MissingFormatError: test_agent","statusTrace":"Format variables:\n  hmnfd_base_url = 'http://cray-hmnfd:28600'\n  test_agent = '???'\n  verify = 'False'\n  test_agent = '???'\n\nSource test stage (line 178):\n  - name: Verify that HMNFD properly handles requests to create state change notification subscriptions for invalid xnames\n    request:\n      url: \"{hmnfd_base_url}/hmi/v2/subscriptions/fake/agents/{test_agent}\"\n      method: POST\n      verify: !bool \"{verify}\"\n    response:\n      status_code: 400\n      verify_response_with:\n        function: tavern.testutils.helpers:validate_pykwalify\n        extra_kwargs:\n          schema:\n            type: map\n            mapping:\n              type:\n                type: str\n                required: True\n                enum:\n                  - \"about:blank\"\n              title:\n                type: str\n                required: True\n                enum:\n                  - \"Invalid Request\"\n              detail:\n                type: str\n                required: True\n                enum:\n                  - \"Invalid XName in URL path\"\n              instance:\n                type: str\n                required: True\n                enum:\n                  - \"/hmi/v2/subscriptions/fake/agents/{test_agent}\"\n              status:\n                type: int\n                required: True\n                enum:\n                  - 400\n\n\n\nMissing format vars for stage\n\nErrors:\nE   tavern.util.exceptions.MissingFormatError: test_agent","steps":[{"name":"Stage 0: Retrieve a node from HSM to be used in later stages","time":{"start":1689667775290,"stop":1689667775329,"duration":39},"status":"passed","steps":[],"attachments":[{"uid":"2a5795170b98ed20","name":"stage_yaml","source":"2a5795170b98ed20.yaml","type":"application/yaml","size":282},{"uid":"c3f78ad64c5dd26a","name":"rest_request","source":"c3f78ad64c5dd26a.yaml","type":"application/yaml","size":149},{"uid":"795d8c412fb3cb36","name":"rest_response","source":"795d8c412fb3cb36.yaml","type":"application/yaml","size":5935}],"parameters":[],"stepsCount":0,"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true},{"name":"Stage 1: Verify that HMNFD properly handles requests to retrieve state change notification subscriptions for invalid xnames","time":{"start":1689667775331,"stop":1689667775342,"duration":11},"status":"passed","steps":[],"attachments":[{"uid":"11725ccf0996226a","name":"stage_yaml","source":"11725ccf0996226a.yaml","type":"application/yaml","size":1075},{"uid":"a145dcf7210c4454","name":"rest_request","source":"a145dcf7210c4454.yaml","type":"application/yaml","size":130},{"uid":"b46997803dc39fe0","name":"rest_response","source":"b46997803dc39fe0.yaml","type":"application/yaml","size":295}],"parameters":[],"stepsCount":0,"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true},{"name":"Stage 2: Verify that HMNFD properly handles requests to retrieve state change notification subscriptions for non-present xnames","time":{"start":1689667775344,"stop":1689667775354,"duration":10},"status":"passed","steps":[],"attachments":[{"uid":"1f85dce940c645f2","name":"stage_yaml","source":"1f85dce940c645f2.yaml","type":"application/yaml","size":476},{"uid":"e7aea32c181c0b9b","name":"rest_request","source":"e7aea32c181c0b9b.yaml","type":"application/yaml","size":139},{"uid":"b50212dcb645e8db","name":"rest_response","source":"b50212dcb645e8db.yaml","type":"application/yaml","size":177}],"parameters":[],"stepsCount":0,"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true},{"name":"Stage 3: Verify that HMNFD properly handles requests to delete state change notification subscriptions for invalid xnames","time":{"start":1689667775355,"stop":1689667775366,"duration":11},"status":"passed","steps":[],"attachments":[{"uid":"d544890561ea9ced","name":"stage_yaml","source":"d544890561ea9ced.yaml","type":"application/yaml","size":1090},{"uid":"5243f300d1467da6","name":"rest_request","source":"5243f300d1467da6.yaml","type":"application/yaml","size":140},{"uid":"8ff42bb41331a2b","name":"rest_response","source":"8ff42bb41331a2b.yaml","type":"application/yaml","size":302}],"parameters":[],"stepsCount":0,"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true},{"name":"Stage 4: Verify that HMNFD properly handles requests to delete state change notification subscriptions for non-present xnames","time":{"start":1689667775367,"stop":1689667775376,"duration":9},"status":"passed","steps":[],"attachments":[{"uid":"11fe555a5ade42a2","name":"stage_yaml","source":"11fe555a5ade42a2.yaml","type":"application/yaml","size":288},{"uid":"be4b775827339463","name":"rest_request","source":"be4b775827339463.yaml","type":"application/yaml","size":149},{"uid":"4352a0b0a6bc6f99","name":"rest_response","source":"4352a0b0a6bc6f99.yaml","type":"application/yaml","size":101}],"parameters":[],"stepsCount":0,"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true},{"name":"Stage 5: Verify that HMNFD properly handles requests to create state change notification subscriptions for invalid xnames","time":{"start":1689667775377,"stop":1689667775380,"duration":3},"status":"failed","statusMessage":"tavern.util.exceptions.MissingFormatError: test_agent\n","statusTrace":"  File \"/usr/lib/python3.9/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n  File \"/usr/lib/python3.9/site-packages/tavern/util/retry.py\", line 31, in wrapped\n    res = fn(*args, **kwargs)\n  File \"/usr/lib/python3.9/site-packages/tavern/core.py\", line 249, in run_stage\n    r = get_request_type(stage, test_block_config, sessions)\n  File \"/usr/lib/python3.9/site-packages/tavern/plugins.py\", line 213, in get_request_type\n    request_maker = request_class(session, request_args, test_block_config)\n  File \"/usr/lib/python3.9/site-packages/tavern/_plugins/rest/request.py\", line 484, in __init__\n    request_args = get_request_args(rspec, test_block_config)\n  File \"/usr/lib/python3.9/site-packages/tavern/_plugins/rest/request.py\", line 86, in get_request_args\n    fspec = format_keys(rspec, test_block_config[\"variables\"])\n  File \"/usr/lib/python3.9/site-packages/tavern/util/dict_util.py\", line 116, in format_keys\n    formatted[key] = format_keys(val[key], box_vars)\n  File \"/usr/lib/python3.9/site-packages/tavern/util/dict_util.py\", line 122, in format_keys\n    formatted = _check_and_format_values(val, box_vars)\n  File \"/usr/lib/python3.9/site-packages/tavern/util/dict_util.py\", line 40, in _check_and_format_values\n    raise exceptions.MissingFormatError(field_name) from e\n","steps":[],"attachments":[{"uid":"fe206c1dc31085b","name":"stage_yaml","source":"fe206c1dc31085b.yaml","type":"application/yaml","size":1114}],"parameters":[],"stepsCount":0,"attachmentsCount":1,"shouldDisplayMessage":true,"hasContent":true}],"attachments":[{"uid":"b08f2d5c01dc3e76","name":"error_output","source":"b08f2d5c01dc3e76.attach","type":"text/plain","size":1443},{"uid":"dc220ea71581aa2b","name":"log","source":"dc220ea71581aa2b.txt","type":"text/plain","size":1991}],"parameters":[],"stepsCount":6,"attachmentsCount":18,"shouldDisplayMessage":true,"hasContent":true},"afterStages":[],"labels":[{"name":"parentSuite","value":"cray-hmnfd-hmth-test"},{"name":"suite","value":"non-disruptive"},{"name":"host","value":"15e2a1548fe8"},{"name":"thread","value":"8-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"api.1-non-disruptive.test_subscriptions_negative.tavern"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":7,"broken":0,"skipped":0,"passed":0,"unknown":0,"total":7},"items":[{"uid":"3217a4d8277908c3","status":"failed","statusDetails":"tavern.util.exceptions.MissingFormatError: test_agent","time":{"start":1689581394673,"stop":1689581394780,"duration":107}},{"uid":"f97d8f49c152e7ce","status":"failed","statusDetails":"tavern.util.exceptions.MissingFormatError: test_agent","time":{"start":1689494969478,"stop":1689494969578,"duration":100}},{"uid":"3535cf8618466de0","status":"failed","statusDetails":"tavern.util.exceptions.MissingFormatError: test_agent","time":{"start":1689408563422,"stop":1689408563525,"duration":103}},{"uid":"d4ade17fa40b03ba","status":"failed","statusDetails":"tavern.util.exceptions.MissingFormatError: test_agent","time":{"start":1689390355510,"stop":1689390355609,"duration":99}},{"uid":"8f89bbc71b9f2c07","status":"failed","statusDetails":"tavern.util.exceptions.MissingFormatError: test_agent","time":{"start":1689322233090,"stop":1689322233235,"duration":145}},{"uid":"6788c4fdbe1f3926","status":"failed","statusDetails":"tavern.util.exceptions.MissingFormatError: test_agent","time":{"start":1689235803886,"stop":1689235803993,"duration":107}}]},"tags":[]},"source":"f71fb53b7360f548.json","parameterValues":[]}